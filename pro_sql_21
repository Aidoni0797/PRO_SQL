pro_sql_21

Grouping

In SQL, the GROUP BY clause is used tp group together rows that have the same values in one or more columns.

The GROUP BY clause is often used in conjuction with aggregate functions such as SUM, AVG, MIN, MAX and COUNT to perform calculations on the gourped data.

For example, consider a movies table with the following columns:
id - title - release_year - genre - reting
1 - The Shawshank Redemption - 1994 - Drama - 9
2 - The Godfather - 1972 - Cime - 9
3 - The Godfather: Part II  - 1974 - Crime - 9
4 - The Dark Knight - 2008 - Action - 9
5 - 12 Angry Men - 1957 - Drama - 8
6 - Schindlers List - 1993 - Birgraphy - 8
7 - Pulp Fiction - 1994 - Crime - 8
8 - The Lord of the Rings: The Return of the King - 2003 - Adventure - 8 
9 - Fight Club - 1999 - Drama - 8
10 - THe Good, the Bad and the Ugly - 1966 - Western - 8

The group the movies by genre and calculate the average rating for each genre, you could use the following SQL query:
SELECT genre, AVG(rating) FROM movies GROUP BY genre

genre - avg_rating
Action - 9.0
Adventure - 8.0
Biography - 8.0
Crime - 8.666666666667
Drama - 8.333333333333
Western - 8.0

This would produce a result set with one row for each unique genre in thee movies table, and the ag_rating column would contain the average rating for all movies in that genre.

You can also use the HAVING clause to filter the groups based on a condition.
For example,  to only show genres with an average rating greater than 8, you could use the following query:
SELECT genre, AVG(rating) AS avg_rating FROM movies GROUP BY genre HAVING ANG(rating)>8

genre - avg_rating
Action - 9.0
Crime - 8.666666666667
Drama - 8.333333333333

To round the results of an aggregate function such as AVG, you can use the ROUND function, The Round
